- name: Web nodes
  hosts: web
  roles:
    - { role: ssh_hardening, tags: [ssh] }
    - { role: vector, tags: [vector] }
    - { role: node_agent, tags: [node-agent] }
    - { role: nginx, tags: [nginx] }
    - { role: php, tags: [php] }
    - { role: composer, tags: [composer] }
    - { role: ceph_client, tags: [ceph-client] }
    - { role: supervisor, tags: [supervisor] }

- name: Database nodes
  hosts: db
  roles:
    - { role: ssh_hardening, tags: [ssh] }
    - { role: vector, tags: [vector] }
    - { role: node_agent, tags: [node-agent] }
    - { role: mysql, tags: [mysql] }

- name: DNS nodes
  hosts: dns
  roles:
    - { role: ssh_hardening, tags: [ssh] }
    - { role: vector, tags: [vector] }
    - { role: node_agent, tags: [node-agent] }
    - { role: powerdns, tags: [powerdns] }

- name: Valkey nodes
  hosts: valkey
  roles:
    - { role: ssh_hardening, tags: [ssh] }
    - { role: vector, tags: [vector] }
    - { role: node_agent, tags: [node-agent] }
    - { role: valkey_server, tags: [valkey] }

- name: Email nodes
  hosts: email
  roles:
    - { role: ssh_hardening, tags: [ssh] }
    - { role: vector, tags: [vector] }
    - { role: node_agent, tags: [node-agent] }
    - { role: stalwart, tags: [stalwart] }

- name: Storage nodes
  hosts: storage
  roles:
    - { role: ssh_hardening, tags: [ssh] }
    - { role: vector, tags: [vector] }
    - { role: node_agent, tags: [node-agent] }
    - { role: ceph_server, tags: [ceph-server] }

- name: Load balancer nodes
  hosts: lb
  roles:
    - { role: ssh_hardening, tags: [ssh] }
    - { role: vector, tags: [vector] }
    - { role: node_agent, tags: [node-agent] }
    - { role: haproxy, tags: [haproxy] }

- name: DB Admin nodes
  hosts: dbadmin
  roles:
    - { role: ssh_hardening, tags: [ssh] }
    - { role: vector, tags: [vector] }
    - { role: node_agent, tags: [node-agent] }
    - { role: docker, tags: [docker] }
    - { role: cloudbeaver, tags: [cloudbeaver] }

- name: Control plane nodes
  hosts: controlplane
  roles:
    - { role: vector, tags: [vector] }
    - { role: k3s, tags: [k3s] }
